{% extends 'budget/base.html' %}
{% load humanize %}

{% block content %}
<div class="d-flex justify-content-between align-items-center">
  <h1>Items</h1>
  <a
    class="btn btn-primary d-flex align-items-center"
    href="{% url 'budget:add_item' %}"
  >
    <span class="material-symbols-outlined">add</span>
    Add item
  </a>
</div>

<form class="row" method="GET">
  <div class="col-lg-4 col-sm-6 col-12">
    <label for="{{ form.title.id_for_label }}"
      >{{ form.title.label }}:</label
    >
    <input
      type="text"
      class="form-control"
      id="{{ form.title.id_for_label }}"
      name="{{ form.title.html_name }}"
      placeholder="Search by {{ form.title.label }}"
      {% if form.title.value != None %}
      value="{{ form.title.value }}"
      {% endif %}
    />
  </div>
  <div class="col-lg-4 col-sm-6 col-12">
    <label for="{{ form.category.id_for_label }}"
      >{{ form.category.label }}:</label
    >
    <input
      type="text"
      class="form-control"
      id="{{ form.category.id_for_label }}"
      name="{{ form.category.html_name }}"
      placeholder="Search by {{ form.category.label }}"
      {% if form.category.value != None %}
      value="{{ form.category.value }}"
      {% endif %}
    />
  </div>
  <div class="col-lg-3 col-sm-10 col-9">
    <label for="{{ form.ordering.id_for_label }}"
      >{{ form.ordering.label }}:</label
    >
    <select
      class="form-select"
      id="{{ form.ordering.id_for_label }}"
      name="{{ form.ordering.html_name }}"
      onchange="this.form.submit()"
    >
      {% for item in form.ordering %}
        <option
          value="{{ item.data.value }}"
          {% if item.data.selected %}
          selected
          {% endif %}
        >
          {{ item.data.label }}
        </option>
      {% endfor %}
    </select>
  </div>
  <div class="col-lg-1 col-sm-2 col-3">
    <label>Search:</label>
    <button type="submit" class="form-control btn btn-outline-secondary">
      <span
        class="material-symbols-outlined d-flex justify-content-center align-items-center"
        >search</span
      >
    </button>
  </div>
</form>

<table class="table table-striped">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Date</th>
      <th scope="col">Title</th>
      <th scope="col">Cost</th>
      <th scope="col">Category</th>
      <th scope="col" class="text-end">Edit</th>
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
    <tr>
      <th scope="row">{{ forloop.counter }}</th>
      <td>{{ item.date|date:"Y M d H:i" }}</td>
      <td>{{ item.title|truncatechars:25 }}</td>
      <td>{{ item.cost|intcomma }} â‚½</td>
      <td>{{ item.category|truncatechars:25 }}</td>
      <td class="text-end">
        <a
          class="btn btn-outline-secondary"
          href="{% url 'budget:edit_item' item.pk %}"
        >
          <span class="material-symbols-outlined">edit</span>
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% block pagination %}
  {% include './_blocks/pagination.html' %}
{% endblock %}
{% endblock %}
